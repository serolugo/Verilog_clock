// Mealy-type FSM

module fsm (
    input  wire clk,
    input  wire reset,     
    // Inputs
    input  wire btn_3,
    // Outputs 
    output reg [1:0] state_out
);

    localparam [1:0]
        S_CLOCK = 2b'00,
        S_ALARM = 2b'01,
		  S_CRON  = 2b'10,
        S_TEMP  = 2b'11;

    reg [1:0] state, state_n;

    // State register
    always @(posedge clk) begin
        if (!reset)
            state <= S_CLOCK;
        else
            state <= state_n;
    end

    // Next-state logic
    always @* begin
        state_n = state;
        case (state)
            S_CLOCK: begin
                if (btn_3) state_n = S_ALARM;
            end
            S_ALARM: begin
                if (btn_3) state_n = S_CRON;
            end
				S_CRON: begin
                if (btn_3) state_n = S_TEMP;
            end
				S_TEMP: begin
                if (btn_3) state_n = S_CLOCK;
            end
            default: begin
                state_n = S_CLOCK;
            end
        endcase
    end

    // Mealy outputs 
    always @* begin
        // defaults
	
        case (state)
			     S_CLOCK: begin
						state_out = 2'b00;
            end
              S_ALARM: begin
						state_out = 2'b01;
            end
				  S_CRON: begin
						state_out = 2'b10;
            end
				  S_TEMP: begin
						state_out = 2'b11;
            end
            default: begin
              	  state_out = 2'b00;
            end
        endcase
    end

endmodule
